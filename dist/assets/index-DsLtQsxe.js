(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function r(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(e){if(e.ep)return;e.ep=!0;const s=r(e);fetch(e.href,s)}})();function h(){const n=document.getElementById("year");n&&(n.textContent=String(new Date().getFullYear()))}function y(){document.querySelectorAll('header a[href^="#"], nav a[href^="#"]').forEach(o=>{o.addEventListener("click",r=>{const c=o.getAttribute("href");if(!c||c==="#")return;const e=document.querySelector(c);e&&(r.preventDefault(),e.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,"",c))})})}function g(){const n=document.getElementById("backToTop"),o=()=>{if(!n)return;const r=window.scrollY>400;n.classList.toggle("opacity-100",r),n.classList.toggle("pointer-events-auto",r),n.classList.toggle("opacity-0",!r),n.classList.toggle("pointer-events-none",!r)};window.addEventListener("scroll",o,{passive:!0}),o(),n?.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function w(){h(),y(),g()}function L(n,o,r){const c=encodeURIComponent(n||""),e=encodeURIComponent(o||""),s=encodeURIComponent(r||"");return`Заявка с сайта «Подкова»%0AИмя: ${c}%0AТелефон: ${e}%0AСообщение: ${s}`}function v(){document.getElementById("contactSubmit")?.addEventListener("click",()=>{const o=(document.getElementById("cf-name")?.value||"").trim(),r=(document.getElementById("cf-phone")?.value||"").trim(),c=(document.getElementById("cf-message")?.value||"").trim(),e=L(o,r,c),u=`https://t.me/share/url?url=${encodeURIComponent("https://example.com")}&text=${e}`,m=`tg://msg?text=${e}`,l=window.open(m,"_blank");setTimeout(()=>{(!l||l.closed||typeof l.closed>"u")&&window.open(u,"_blank")},300)})}function E(){const n=Array.from(document.querySelectorAll("video.hero-video")),o=Array.from(document.querySelectorAll(".hero-poster"));if(!n.length)return;const r=t=>{try{t.muted=!0,t.playsInline=!0,t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline","")}catch{}},c=t=>t.offsetParent!==null||getComputedStyle(t).display!=="none",e=t=>{if(!t)return;r(t);const i=t.play();i&&typeof i.then=="function"&&i.catch(()=>{})},s=t=>{try{t.pause()}catch{}},u=t=>{let i=t.previousElementSibling;for(;i&&!i.classList?.contains("hero-poster");)i=i.previousElementSibling;return i&&i.classList?.contains("hero-poster")?i:o.find(f=>t.classList.contains("sm:hidden")&&f.classList.contains("sm:hidden")||t.classList.contains("sm:block")&&f.classList.contains("sm:block"))||null};let m;const l=()=>{const t=n.find(c)||n[0];n.forEach(d=>{d!==t&&(s(d),d.classList.remove("is-ready"))}),o.forEach(d=>d.classList.remove("is-hidden"));const i=u(t),f=()=>{r(t);const d=()=>{t.classList.add("is-ready"),i&&i.classList.add("is-hidden")};t.addEventListener("playing",d,{once:!0}),t.addEventListener("canplay",d,{once:!0}),e(t)};clearTimeout(m),m=setTimeout(f,1e3)};l();let p;window.addEventListener("resize",()=>{clearTimeout(p),p=setTimeout(l,200)});const a=()=>{l(),window.removeEventListener("pointerdown",a,!0),window.removeEventListener("keydown",a,!0),window.removeEventListener("touchstart",a,!0),window.removeEventListener("scroll",a,!0)};window.addEventListener("pointerdown",a,!0),window.addEventListener("keydown",a,!0),window.addEventListener("touchstart",a,!0),window.addEventListener("scroll",a,!0),document.addEventListener("visibilitychange",()=>{document.hidden||l()})}document.addEventListener("DOMContentLoaded",()=>{w(),v(),E()});
